@model CardTariffsDto

<div class="main-content-block">
    <div class="add-entity-block">
        <form asp-controller="Card" asp-action="UpdateCard" asp-route-bankId="@Model.BankId" method="post" class="add-form">
            <h2>@Localizer["update"] @ViewBag.BankName</h2>
            <input asp-for="BankId" value="@Model.BankId" type="hidden">
            <label>
                @Localizer["cardName"]
                <input asp-for="CardName">
            </label>
            <div class="radio-elements">
                <label>@Localizer["cardType"]</label>
                @if (Model.Type == CardType.Credit)
                {
                    <label>
                        <input type="radio" name="Type" value="@CardType.Credit" checked /> @Localizer["credit"]
                    </label>
                    <label>
                        <input type="radio" name="Type" value="@CardType.Debit" /> @Localizer["debit"]
                    </label>
                }
                else
                {
                    <label>
                        <input type="radio" name="Type" value="@CardType.Credit" /> @Localizer["credit"]
                    </label>
                    <label>
                        <input type="radio" name="Type" value="@CardType.Debit" checked /> @Localizer["debit"]
                    </label>
                }
            </div>
            <div class="radio-elements">
                <label>@Localizer["cardLevel"]</label>
                @if (Model.Level== CardLevel.Normal)
                {
                    <label>
                        <input asp-for="Level" type="radio" value="@CardLevel.Normal" checked /> @Localizer["classic"]
                    </label>
                    <label>
                        <input asp-for="Level" type="radio" value="@CardLevel.Premium" /> @Localizer["premium"]
                    </label>
                }
                else
                {
                    <label>
                        <input asp-for="Level" type="radio" value="@CardLevel.Normal" /> @Localizer["classic"]
                    </label>
                    <label>
                        <input asp-for="Level" type="radio" value="@CardLevel.Premium" checked /> @Localizer["premium"]
                    </label>
                }

            </div>
            <label>
                @Localizer["validityPeriod"]
                <input asp-for="ValidityPeriod" step="0.5" maxlength="4" required oninput="this.value = this.value.replace('.', ',')">
            </label>
            <label id="credit-limit">
                @Localizer["creditLimit"]
                <input asp-for="MaxCreditLimit">
            </label>
            <label id="interest-rate">
                @Localizer["interestRate"]
                <input asp-for="InterestRate" step="0.1" maxlength="4" oninput="this.value = this.value.replace('.', ',')">
            </label>

            <div class="radio-elements">
                <label>@Localizer["paymentSystems"]</label>
                @if (Model.EnabledPaymentSystems!=null && Model.EnabledPaymentSystems.Contains(PaymentSystem.Visa))
                {
                    <label>
                        <input name="EnabledPaymentSystems" type="checkbox" value="@PaymentSystem.Visa" checked/> Visa
                    </label>
                }
                else
                {
                    <label>
                        <input name="EnabledPaymentSystems" type="checkbox" value="@PaymentSystem.Visa" /> Visa
                    </label>
                }

                @if (Model.EnabledPaymentSystems != null && Model.EnabledPaymentSystems.Contains(PaymentSystem.Mastercard))
                {
                    <label>
                        <input name="EnabledPaymentSystems" type="checkbox" value="@PaymentSystem.Mastercard" checked/> Mastercard
                    </label>
                }
                else
                {
                    <label>
                        <input name="EnabledPaymentSystems" type="checkbox" value="@PaymentSystem.Mastercard" /> Mastercard
                    </label>
                }
            </div>

            <div class="radio-elements">
                <label>@Localizer["currency"]</label>
                @if (Model.EnableCurency!=null && Model.EnableCurency.Contains(CardCurrency.UAH))
                {
                    <label>
                        <input name="EnableCurency" type="checkbox" value="@CardCurrency.UAH" checked />UAH
                    </label>
                }
                else
                {
                    <label>
                        <input name="EnableCurency" type="checkbox" value="@CardCurrency.UAH"/>UAH
                    </label>
                }

                @if (Model.EnableCurency != null && Model.EnableCurency.Contains(CardCurrency.USD))
                {
                    <label>
                        <input name="EnableCurency" type="checkbox" value="@CardCurrency.USD" checked/> USD
                    </label>
                }
                else
                {
                    <label>
                        <input name="EnableCurency" type="checkbox" value="@CardCurrency.USD" /> USD
                    </label>
                }

                @if (Model.EnableCurency != null && Model.EnableCurency.Contains(CardCurrency.EUR))
                {
                    <label>
                        <input name="EnableCurency" type="checkbox" value="@CardCurrency.EUR" checked/> EUR
                    </label>
                }
                else
                {
                    <label>
                        <input name="EnableCurency" type="checkbox" value="@CardCurrency.EUR" /> EUR
                    </label>
                }

            </div>

            <label>
                @Localizer["maintenanceCost"]
                <input asp-for="AnnualMaintenanceCost" type="number">
            </label>
            <label>
                @Localizer["p2pToAnother"]
                <input asp-for="P2PToAnotherBankCommission" oninput="this.value = this.value.replace('.', ',')">
            </label>
            <label>
                @Localizer["p2pInternal"]
                <input asp-for="P2PInternalCommission" oninput="this.value = this.value.replace('.', ',')">
            </label>
            <label>
                @Localizer["bin"]
                <input asp-for="BIN">
            </label>
            <label class="color-picker-wrapper">
                @Localizer["cardColor"]
                <div class="color-preview">
                    <input type="color" id="card-color" asp-for="CardColor" value="@Model.CardColor">
                </div>
            </label>


            @if (ViewBag.Message != null)
            {
                @if (ViewBag.Message == "Success!")
                {
                    <span class="success-message">@Model.CardName @Localizer["successUpdate"]</span>
                }
                @if (ViewBag.Message != "Success!")
                {
                    <div class="error-validation-message">
                        <span>@Localizer["error"]</span>
                        <ul>
                            @foreach (var error in ViewBag.Errors)
                            {
                                <li>@error</li>
                            }
                        </ul>
                    </div>
                }
            }
            <button type="submit" class="create-element">@Localizer["updateButton"]</button>
        </form>
    </div>
</div>

@section backButton {
    @if (ViewBag.ReturnActionUrl == "cardTariffsList")
    {
        <a asp-controller="CardTariffs" asp-action="CardTariffsList" class="text-reset text-decoration-none back-link d-flex align-items-center">
            <img src="~/images/main-page/arrow-to-left-icon.svg" alt="Back" />
        </a>
    }
    else
    {
        <a asp-controller="CardTariffs" asp-action="CardTariffsInfo" asp-route-cardId="@Model.Id" class="text-reset text-decoration-none back-link d-flex align-items-center">
            <img src="~/images/main-page/arrow-to-left-icon.svg" alt="Back" />
        </a>
    }
}

@section additionalScripts {
    <script type="module" src="~/js/entities/card-tariffs/AddCardInputsHandler.js" defer></script>
    <script type="module" src="~/js/entities/card-tariffs/cardTariffsMenu.js" defer></script>
}

